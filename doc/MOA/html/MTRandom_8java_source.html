<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MOA: main/java/moa/clusterers/streamkm/MTRandom.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>main/java/moa/clusterers/streamkm/MTRandom.java</h1><a href="MTRandom_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * MTRandom : A Java implementation of the MT19937 (Mersenne Twister)</span>
<a name="l00003"></a>00003 <span class="comment"> *            pseudo random number generator algorithm based upon the</span>
<a name="l00004"></a>00004 <span class="comment"> *            original C code by Makoto Matsumoto and Takuji Nishimura.</span>
<a name="l00005"></a>00005 <span class="comment"> * Author   : David Beaumont</span>
<a name="l00006"></a>00006 <span class="comment"> * Email    : mersenne-at-www.goui.net</span>
<a name="l00007"></a>00007 <span class="comment"> * </span>
<a name="l00008"></a>00008 <span class="comment"> * For the original C code, see:</span>
<a name="l00009"></a>00009 <span class="comment"> *     http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * This version, Copyright (C) 2005, David Beaumont.</span>
<a name="l00012"></a>00012 <span class="comment"> * </span>
<a name="l00013"></a>00013 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00014"></a>00014 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00015"></a>00015 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00016"></a>00016 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00017"></a>00017 <span class="comment"> * </span>
<a name="l00018"></a>00018 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00019"></a>00019 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00020"></a>00020 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00021"></a>00021 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00022"></a>00022 <span class="comment"> * </span>
<a name="l00023"></a>00023 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00024"></a>00024 <span class="comment"> * License along with this library.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00025"></a>00025 <span class="comment"> * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">package </span>moa.clusterers.streamkm;
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">import</span> java.util.Random;
<a name="l00031"></a>00031 
<a name="l00084"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html">00084</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html">MTRandom</a> <span class="keyword">extends</span> Random {
<a name="l00085"></a>00085 
<a name="l00092"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a25a01948b53441240a8478c7dc79c13c">00092</a>     <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">long</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a25a01948b53441240a8478c7dc79c13c" title="Auto-generated serial version UID.">serialVersionUID</a> = -515082678588212038L;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094     <span class="comment">// Constants used in the original C implementation</span>
<a name="l00095"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5b9ada3a03baa8edb60837542fcf332a">00095</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5b9ada3a03baa8edb60837542fcf332a">UPPER_MASK</a> = 0x80000000;
<a name="l00096"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a283f1b8d2724dafda1492f65d162ff37">00096</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a283f1b8d2724dafda1492f65d162ff37">LOWER_MASK</a> = 0x7fffffff;
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">00098</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a> = 624;
<a name="l00099"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a97229e51b0e7ba59266ffa6f8a08b904">00099</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a97229e51b0e7ba59266ffa6f8a08b904">M</a> = 397;
<a name="l00100"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3f81e4c9de1c0dca58b54b96b6ce099e">00100</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3f81e4c9de1c0dca58b54b96b6ce099e">MAGIC</a>[] = { 0x0, 0x9908b0df };
<a name="l00101"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5ee19e3f2a5970b5b048af9356d82967">00101</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5ee19e3f2a5970b5b048af9356d82967">MAGIC_FACTOR1</a> = 1812433253;
<a name="l00102"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9c6b66e308d947e8dc1e601c89260920">00102</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9c6b66e308d947e8dc1e601c89260920">MAGIC_FACTOR2</a> = 1664525;
<a name="l00103"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a00d1e3c854fc0d193762b4d788a802e7">00103</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a00d1e3c854fc0d193762b4d788a802e7">MAGIC_FACTOR3</a> = 1566083941;
<a name="l00104"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a7839d398dd7dd6b73b8b0878ba5c75e6">00104</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a7839d398dd7dd6b73b8b0878ba5c75e6">MAGIC_MASK1</a>   = 0x9d2c5680;
<a name="l00105"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#adb98fc9a96cd8372399ce4ff5569d93f">00105</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#adb98fc9a96cd8372399ce4ff5569d93f">MAGIC_MASK2</a>   = 0xefc60000;
<a name="l00106"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a81358d57e8da3b35c20ce674e120331e">00106</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a81358d57e8da3b35c20ce674e120331e">MAGIC_SEED</a>    = 19650218;
<a name="l00107"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#adefa7e0ee0beb16c6b297289544419a8">00107</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">long</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#adefa7e0ee0beb16c6b297289544419a8">DEFAULT_SEED</a> = 5489L;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="comment">// Internal state</span>
<a name="l00110"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">00110</a>     <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keywordtype">int</span>[] <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>;
<a name="l00111"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">00111</a>     <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>;
<a name="l00112"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9ed52c34fde7585914f6cac2a5b33077">00112</a>     <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keywordtype">boolean</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9ed52c34fde7585914f6cac2a5b33077">compat</a> = <span class="keyword">false</span>;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="comment">// Temporary buffer used during setSeed(long)</span>
<a name="l00115"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">00115</a>     <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keywordtype">int</span>[] <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a>;
<a name="l00116"></a>00116 
<a name="l00123"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a76b831b5d8002a14784f3a84a6feecae">00123</a>     <span class="keyword">public</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a76b831b5d8002a14784f3a84a6feecae" title="The default constructor for an instance of MTRandom.">MTRandom</a>() { }
<a name="l00124"></a>00124 
<a name="l00145"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a82dbaafe138aa2539e51978c903f8780">00145</a>     <span class="keyword">public</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a82dbaafe138aa2539e51978c903f8780" title="This version of the constructor can be used to implement identical behaviour to the...">MTRandom</a>(<span class="keywordtype">boolean</span> compatible) {
<a name="l00146"></a>00146         super(0L);
<a name="l00147"></a>00147         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9ed52c34fde7585914f6cac2a5b33077">compat</a> = compatible;
<a name="l00148"></a>00148         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9ed52c34fde7585914f6cac2a5b33077">compat</a>?<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#adefa7e0ee0beb16c6b297289544419a8">DEFAULT_SEED</a>:System.currentTimeMillis());
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00158"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ab245435ee625f669ac2d62f74c8a5d78">00158</a>     <span class="keyword">public</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ab245435ee625f669ac2d62f74c8a5d78" title="This version of the constructor simply initialises the class with the given 64 bit...">MTRandom</a>(<span class="keywordtype">long</span> seed) {
<a name="l00159"></a>00159         super(seed);
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161 
<a name="l00171"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ad1bcb38ae8ad8646484991667d599502">00171</a>     <span class="keyword">public</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ad1bcb38ae8ad8646484991667d599502" title="This version of the constructor initialises the class with the given byte array.">MTRandom</a>(byte[] buf) {
<a name="l00172"></a>00172         super(0L);
<a name="l00173"></a>00173         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(buf);
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175 
<a name="l00185"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a99651c7ba2830f17308c3c78ec37b610">00185</a>     <span class="keyword">public</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a99651c7ba2830f17308c3c78ec37b610" title="This version of the constructor initialises the class with the given integer array...">MTRandom</a>(<span class="keywordtype">int</span>[] buf) {
<a name="l00186"></a>00186         super(0L);
<a name="l00187"></a>00187         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(buf);
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     <span class="comment">// Initializes mt[N] with a simple integer seed. This method is</span>
<a name="l00191"></a>00191     <span class="comment">// required as part of the Mersenne Twister algorithm but need</span>
<a name="l00192"></a>00192     <span class="comment">// not be made public.</span>
<a name="l00193"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">00193</a>     <span class="keyword">private</span> <span class="keyword">final</span> <span class="keywordtype">void</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(<span class="keywordtype">int</span> seed) {
<a name="l00194"></a>00194 
<a name="l00195"></a>00195         <span class="comment">// Annoying runtime check for initialisation of internal data</span>
<a name="l00196"></a>00196         <span class="comment">// caused by java.util.Random invoking setSeed() during init.</span>
<a name="l00197"></a>00197         <span class="comment">// This is unavoidable because no fields in our instance will</span>
<a name="l00198"></a>00198         <span class="comment">// have been initialised at this point, not even if the code</span>
<a name="l00199"></a>00199         <span class="comment">// were placed at the declaration of the member variable.</span>
<a name="l00200"></a>00200         <span class="keywordflow">if</span> (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a> == null) <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>];
<a name="l00201"></a>00201 
<a name="l00202"></a>00202         <span class="comment">// ---- Begin Mersenne Twister Algorithm ----</span>
<a name="l00203"></a>00203         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[0] = seed;
<a name="l00204"></a>00204         <span class="keywordflow">for</span> (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a> = 1; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a> &lt; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>++) {
<a name="l00205"></a>00205             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>] = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5ee19e3f2a5970b5b048af9356d82967">MAGIC_FACTOR1</a> * (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>-1] ^ (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>-1] &gt;&gt;&gt; 30)) + <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>);
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207         <span class="comment">// ---- End Mersenne Twister Algorithm ----</span>
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00225"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a300c5d4be53dbffcdf923529c0289308">00225</a>     <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keywordtype">void</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a300c5d4be53dbffcdf923529c0289308" title="This method resets the state of this instance using the 64 bits of seed data provided...">setSeed</a>(<span class="keywordtype">long</span> seed) {
<a name="l00226"></a>00226         <span class="keywordflow">if</span> (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9ed52c34fde7585914f6cac2a5b33077">compat</a>) {
<a name="l00227"></a>00227             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>((<span class="keywordtype">int</span>)seed);
<a name="l00228"></a>00228         } <span class="keywordflow">else</span> {
<a name="l00229"></a>00229 
<a name="l00230"></a>00230             <span class="comment">// Annoying runtime check for initialisation of internal data</span>
<a name="l00231"></a>00231             <span class="comment">// caused by java.util.Random invoking setSeed() during init.</span>
<a name="l00232"></a>00232             <span class="comment">// This is unavoidable because no fields in our instance will</span>
<a name="l00233"></a>00233             <span class="comment">// have been initialised at this point, not even if the code</span>
<a name="l00234"></a>00234             <span class="comment">// were placed at the declaration of the member variable.</span>
<a name="l00235"></a>00235             <span class="keywordflow">if</span> (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a> == null) <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[2];
<a name="l00236"></a>00236 
<a name="l00237"></a>00237             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a>[0] = (int)seed;
<a name="l00238"></a>00238             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a>[1] = (int)(seed &gt;&gt;&gt; 32);
<a name="l00239"></a>00239             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a>);
<a name="l00240"></a>00240         }
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00259"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aa0d7c103a803d7d030d95958d2945b18">00259</a>     <span class="keyword">public</span> <span class="keyword">final</span> <span class="keywordtype">void</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aa0d7c103a803d7d030d95958d2945b18" title="This method resets the state of this instance using the byte array of seed data provided...">setSeed</a>(byte[] buf) {
<a name="l00260"></a>00260         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5aab1cfe7fce672a0b6502ba5e4cd809" title="This simply utility method can be used in cases where a byte array of seed data is...">pack</a>(buf));
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262 
<a name="l00272"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a02c7178f48093792da9cf520308b8ecf">00272</a>     <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keywordtype">void</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a02c7178f48093792da9cf520308b8ecf" title="This method resets the state of this instance using the integer array of seed data...">setSeed</a>(<span class="keywordtype">int</span>[] buf) {
<a name="l00273"></a>00273         <span class="keywordtype">int</span> length = buf.length;
<a name="l00274"></a>00274         <span class="keywordflow">if</span> (length == 0) <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Seed buffer may not be empty&quot;</span>);
<a name="l00275"></a>00275         <span class="comment">// ---- Begin Mersenne Twister Algorithm ----</span>
<a name="l00276"></a>00276         <span class="keywordtype">int</span> i = 1, j = 0, k = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a> &gt; length ? <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a> : length);
<a name="l00277"></a>00277         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af4f0e2909929145346c0009d8d7e6775">setSeed</a>(<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a81358d57e8da3b35c20ce674e120331e">MAGIC_SEED</a>);
<a name="l00278"></a>00278         <span class="keywordflow">for</span> (; k &gt; 0; k--) {
<a name="l00279"></a>00279             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i] = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i] ^ ((<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i-1] ^ (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i-1] &gt;&gt;&gt; 30)) * <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a9c6b66e308d947e8dc1e601c89260920">MAGIC_FACTOR2</a>)) + buf[j] + j;
<a name="l00280"></a>00280             i++; j++;
<a name="l00281"></a>00281             <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>) { <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[0] = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>-1]; i = 1; }
<a name="l00282"></a>00282             <span class="keywordflow">if</span> (j &gt;= length) j = 0;
<a name="l00283"></a>00283         }
<a name="l00284"></a>00284         <span class="keywordflow">for</span> (k = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>-1; k &gt; 0; k--) {
<a name="l00285"></a>00285             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i] = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i] ^ ((<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i-1] ^ (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[i-1] &gt;&gt;&gt; 30)) * <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a00d1e3c854fc0d193762b4d788a802e7">MAGIC_FACTOR3</a>)) - i;
<a name="l00286"></a>00286             i++;
<a name="l00287"></a>00287             <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>) { <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[0] = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>-1]; i = 1; }
<a name="l00288"></a>00288         }
<a name="l00289"></a>00289         <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[0] = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5b9ada3a03baa8edb60837542fcf332a">UPPER_MASK</a>; <span class="comment">// MSB is 1; assuring non-zero initial array</span>
<a name="l00290"></a>00290         <span class="comment">// ---- End Mersenne Twister Algorithm ----</span>
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292 
<a name="l00315"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3e981d6a8dc86e024c261fed6ddbc015">00315</a>     <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keywordtype">int</span> <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3e981d6a8dc86e024c261fed6ddbc015" title="This method forms the basis for generating a pseudo random number sequence from this...">next</a>(<span class="keywordtype">int</span> bits) {
<a name="l00316"></a>00316         <span class="comment">// ---- Begin Mersenne Twister Algorithm ----</span>
<a name="l00317"></a>00317         <span class="keywordtype">int</span> y, kk;
<a name="l00318"></a>00318         <span class="keywordflow">if</span> (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a> &gt;= <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>) {             <span class="comment">// generate N words at one time</span>
<a name="l00319"></a>00319 
<a name="l00320"></a>00320             <span class="comment">// In the original C implementation, mti is checked here</span>
<a name="l00321"></a>00321             <span class="comment">// to determine if initialisation has occurred; if not</span>
<a name="l00322"></a>00322             <span class="comment">// it initialises this instance with DEFAULT_SEED (5489).</span>
<a name="l00323"></a>00323             <span class="comment">// This is no longer necessary as initialisation of the</span>
<a name="l00324"></a>00324             <span class="comment">// Java instance must result in initialisation occurring</span>
<a name="l00325"></a>00325             <span class="comment">// Use the constructor MTRandom(true) to enable backwards</span>
<a name="l00326"></a>00326             <span class="comment">// compatible behaviour.</span>
<a name="l00327"></a>00327             
<a name="l00328"></a>00328             <span class="keywordflow">for</span> (kk = 0; kk &lt; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>-<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a97229e51b0e7ba59266ffa6f8a08b904">M</a>; kk++) {
<a name="l00329"></a>00329                 y = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk] &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5b9ada3a03baa8edb60837542fcf332a">UPPER_MASK</a>) | (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk+1] &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a283f1b8d2724dafda1492f65d162ff37">LOWER_MASK</a>);
<a name="l00330"></a>00330                 <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk] = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk+M] ^ (y &gt;&gt;&gt; 1) ^ <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3f81e4c9de1c0dca58b54b96b6ce099e">MAGIC</a>[y &amp; 0x1];
<a name="l00331"></a>00331             }
<a name="l00332"></a>00332             <span class="keywordflow">for</span> (;kk &lt; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#aeeb3c781267cf6763581caf1a349a901">N</a>-1; kk++) {
<a name="l00333"></a>00333                 y = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk] &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5b9ada3a03baa8edb60837542fcf332a">UPPER_MASK</a>) | (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk+1] &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a283f1b8d2724dafda1492f65d162ff37">LOWER_MASK</a>);
<a name="l00334"></a>00334                 <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk] = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[kk+(M-N)] ^ (y &gt;&gt;&gt; 1) ^ <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3f81e4c9de1c0dca58b54b96b6ce099e">MAGIC</a>[y &amp; 0x1];
<a name="l00335"></a>00335             }
<a name="l00336"></a>00336             y = (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[N-1] &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5b9ada3a03baa8edb60837542fcf332a">UPPER_MASK</a>) | (<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[0] &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a283f1b8d2724dafda1492f65d162ff37">LOWER_MASK</a>);
<a name="l00337"></a>00337             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[N-1] = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[M-1] ^ (y &gt;&gt;&gt; 1) ^ <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a3f81e4c9de1c0dca58b54b96b6ce099e">MAGIC</a>[y &amp; 0x1];
<a name="l00338"></a>00338 
<a name="l00339"></a>00339             <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a> = 0;
<a name="l00340"></a>00340         }
<a name="l00341"></a>00341   
<a name="l00342"></a>00342         y = <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a725e7e4628488e92c5aa555c2921e314">mt</a>[<a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#af04c4bee8fb9746cdb5e3babffc5e562">mti</a>++];
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         <span class="comment">// Tempering</span>
<a name="l00345"></a>00345         y ^= (y &gt;&gt;&gt; 11);
<a name="l00346"></a>00346         y ^= (y &lt;&lt; 7) &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a7839d398dd7dd6b73b8b0878ba5c75e6">MAGIC_MASK1</a>;
<a name="l00347"></a>00347         y ^= (y &lt;&lt; 15) &amp; <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#adb98fc9a96cd8372399ce4ff5569d93f">MAGIC_MASK2</a>;
<a name="l00348"></a>00348         y ^= (y &gt;&gt;&gt; 18);
<a name="l00349"></a>00349         <span class="comment">// ---- End Mersenne Twister Algorithm ----</span>
<a name="l00350"></a>00350         <span class="keywordflow">return</span> (y &gt;&gt;&gt; (32-bits));
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="comment">// This is a fairly obscure little code section to pack a</span>
<a name="l00354"></a>00354     <span class="comment">// byte[] into an int[] in little endian ordering.  </span>
<a name="l00355"></a>00355 
<a name="l00379"></a><a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5aab1cfe7fce672a0b6502ba5e4cd809">00379</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">int</span>[] <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#a5aab1cfe7fce672a0b6502ba5e4cd809" title="This simply utility method can be used in cases where a byte array of seed data is...">pack</a>(byte[] buf) {
<a name="l00380"></a>00380         <span class="keywordtype">int</span> k, blen = buf.length, ilen = ((buf.length+3) &gt;&gt;&gt; 2);
<a name="l00381"></a>00381         <span class="keywordtype">int</span>[] <a class="code" href="classmoa_1_1clusterers_1_1streamkm_1_1MTRandom.html#ae063d92e9f2e71421e29a567ca8ee952">ibuf</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[ilen];
<a name="l00382"></a>00382         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; ilen; n++) {
<a name="l00383"></a>00383             <span class="keywordtype">int</span> m = (n+1) &lt;&lt; 2;
<a name="l00384"></a>00384             <span class="keywordflow">if</span> (m &gt; blen) m = blen;
<a name="l00385"></a>00385             <span class="keywordflow">for</span> (k = buf[--m]&amp;0xff; (m &amp; 0x3) != 0; k = (k &lt;&lt; 8) | buf[--m]&amp;0xff);
<a name="l00386"></a>00386             ibuf[n] = k;
<a name="l00387"></a>00387         }
<a name="l00388"></a>00388         <span class="keywordflow">return</span> ibuf;
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 26 Nov 2014 for MOA by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
